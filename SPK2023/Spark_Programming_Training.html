<!DOCTYPE html>
<html class="title" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"><title>Spark Programming Training</title><meta name="description" content="Spark Programming Training"><meta name="keywords" content="Big data, Machine Learning, Data, Azure Databricks, Apache Spark"><meta name="author" content="Amine HADJ-YOUCEF. PhD"><link rel="stylesheet" href="Spark%20Programming%20Training_files/reset.css"><link rel="stylesheet" href="Spark%20Programming%20Training_files/reveal.css"><link rel="stylesheet" href="Spark%20Programming%20Training_files/white.css" id="theme"><!--This CSS is generated by the Asciidoctor reveal.js converter to further integrate AsciiDoc's existing semantic with reveal.js--><style type="text/css">.reveal div.right {
  float: right
}

/* listing block */
.reveal .listingblock.stretch > .content {
  height: 100%
}

.reveal .listingblock.stretch > .content > pre {
  height: 100%
}

.reveal .listingblock.stretch > .content > pre > code {
  height: 100%;
  max-height: 100%
}

/* tables */
table {
  border-collapse: collapse;
  border-spacing: 0
}

table {
  margin-bottom: 1.25em;
  border: solid 1px #dedede
}

table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
  padding: .5em .625em .625em;
  font-size: inherit;
  text-align: left
}

table tr th, table tr td {
  padding: .5625em .625em;
  font-size: inherit
}

table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
  display: table-cell;
  line-height: 1.6
}

td.tableblock > .content {
  margin-bottom: 1.25em
}

td.tableblock > .content > :last-child {
  margin-bottom: -1.25em
}

table.tableblock, th.tableblock, td.tableblock {
  border: 0 solid #dedede
}

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock {
  border-width: 0 1px 1px 0
}

table.grid-all > tfoot > tr > .tableblock {
  border-width: 1px 1px 0 0
}

table.grid-cols > * > tr > .tableblock {
  border-width: 0 1px 0 0
}

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock {
  border-width: 0 0 1px
}

table.grid-rows > tfoot > tr > .tableblock {
  border-width: 1px 0 0
}

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child {
  border-right-width: 0
}

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock {
  border-bottom-width: 0
}

table.frame-all {
  border-width: 1px
}

table.frame-sides {
  border-width: 0 1px
}

table.frame-topbot, table.frame-ends {
  border-width: 1px 0
}

.reveal table th.halign-left, .reveal table td.halign-left {
  text-align: left
}

.reveal table th.halign-right, .reveal table td.halign-right {
  text-align: right
}

.reveal table th.halign-center, .reveal table td.halign-center {
  text-align: center
}

.reveal table th.valign-top, .reveal table td.valign-top {
  vertical-align: top
}

.reveal table th.valign-bottom, .reveal table td.valign-bottom {
  vertical-align: bottom
}

.reveal table th.valign-middle, .reveal table td.valign-middle {
  vertical-align: middle
}

table thead th, table tfoot th {
  font-weight: bold
}

tbody tr th {
  display: table-cell;
  line-height: 1.6
}

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
  font-weight: bold
}

thead {
  display: table-header-group
}

.reveal table.grid-none th, .reveal table.grid-none td {
  border-bottom: 0 !important
}

/* kbd macro */
kbd {
  font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
  display: inline-block;
  color: rgba(0, 0, 0, .8);
  font-size: .65em;
  line-height: 1.45;
  background: #f7f7f7;
  border: 1px solid #ccc;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em white inset;
  box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em #fff inset;
  margin: 0 .15em;
  padding: .2em .5em;
  vertical-align: middle;
  position: relative;
  top: -.1em;
  white-space: nowrap
}

.keyseq kbd:first-child {
  margin-left: 0
}

.keyseq kbd:last-child {
  margin-right: 0
}

/* callouts */
.conum[data-value] {
  display: inline-block;
  color: #fff !important;
  background: rgba(0, 0, 0, .8);
  -webkit-border-radius: 50%;
  border-radius: 50%;
  text-align: center;
  font-size: .75em;
  width: 1.67em;
  height: 1.67em;
  line-height: 1.67em;
  font-family: "Open Sans", "DejaVu Sans", sans-serif;
  font-style: normal;
  font-weight: bold
}

.conum[data-value] * {
  color: #fff !important
}

.conum[data-value] + b {
  display: none
}

.conum[data-value]:after {
  content: attr(data-value)
}

pre .conum[data-value] {
  position: relative;
  top: -.125em
}

b.conum * {
  color: inherit !important
}

.conum:not([data-value]):empty {
  display: none
}

/* Callout list */
.hdlist > table, .colist > table {
  border: 0;
  background: none
}

.hdlist > table > tbody > tr, .colist > table > tbody > tr {
  background: none
}

td.hdlist1, td.hdlist2 {
  vertical-align: top;
  padding: 0 .625em
}

td.hdlist1 {
  font-weight: bold;
  padding-bottom: 1.25em
}

/* Disabled from Asciidoctor CSS because it caused callout list to go under the
 * source listing when .stretch is applied (see #335)
 * .literalblock+.colist,.listingblock+.colist{margin-top:-.5em} */
.colist td:not([class]):first-child {
  padding: .4em .75em 0;
  line-height: 1;
  vertical-align: top
}

.colist td:not([class]):first-child img {
  max-width: none
}

.colist td:not([class]):last-child {
  padding: .25em 0
}

/* Override Asciidoctor CSS that causes issues with reveal.js features */
.reveal .hljs table {
  border: 0
}

/* Callout list rows would have a bottom border with some reveal.js themes (see #335) */
.reveal .colist > table th, .reveal .colist > table td {
  border-bottom: 0
}

/* Fixes line height with Highlight.js source listing when linenums enabled (see #331) */
.reveal .hljs table thead tr th, .reveal .hljs table tfoot tr th, .reveal .hljs table tbody tr td, .reveal .hljs table tr td, .reveal .hljs table tfoot tr td {
  line-height: inherit
}

/* Columns layout */
.columns .slide-content {
  display: flex;
}

.columns.wrap .slide-content {
  flex-wrap: wrap;
}

.columns.is-vcentered .slide-content {
  align-items: center;
}

.columns .slide-content > .column {
  display: block;
  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 1;
}

.columns .slide-content > .column > * {
  padding: .75rem;
}

/* See #353 */
.columns.wrap .slide-content > .column {
  flex-basis: auto;
}

.columns .slide-content > .column.is-full {
  flex: none;
  width: 100%;
}

.columns .slide-content > .column.is-four-fifths {
  flex: none;
  width: 80%;
}

.columns .slide-content > .column.is-three-quarters {
  flex: none;
  width: 75%;
}

.columns .slide-content > .column.is-two-thirds {
  flex: none;
  width: 66.6666%;
}

.columns .slide-content > .column.is-three-fifths {
  flex: none;
  width: 60%;
}

.columns .slide-content > .column.is-half {
  flex: none;
  width: 50%;
}

.columns .slide-content > .column.is-two-fifths {
  flex: none;
  width: 40%;
}

.columns .slide-content > .column.is-one-third {
  flex: none;
  width: 33.3333%;
}

.columns .slide-content > .column.is-one-quarter {
  flex: none;
  width: 25%;
}

.columns .slide-content > .column.is-one-fifth {
  flex: none;
  width: 20%;
}

.columns .slide-content > .column.has-text-left {
  text-align: left;
}

.columns .slide-content > .column.has-text-justified {
  text-align: justify;
}

.columns .slide-content > .column.has-text-right {
  text-align: right;
}

.columns .slide-content > .column.has-text-left {
  text-align: left;
}

.columns .slide-content > .column.has-text-justified {
  text-align: justify;
}

.columns .slide-content > .column.has-text-right {
  text-align: right;
}

.text-left {
  text-align: left !important
}

.text-right {
  text-align: right !important
}

.text-center {
  text-align: center !important
}

.text-justify {
  text-align: justify !important
}

.footnotes {
  border-top: 1px solid rgba(0, 0, 0, 0.2);
  padding: 0.5em 0 0 0;
  font-size: 0.65em;
  margin-top: 4em;
}
</style><link rel="stylesheet" href="Spark%20Programming%20Training_files/all.min.css"><link rel="stylesheet" href="Spark%20Programming%20Training_files/v4-shims.min.css"><script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({
tex2jax: {
  inlineMath: [["\\(", "\\)"]],
  displayMath: [["\\[", "\\]"]],
  ignoreClass: "nostem|nolatexmath"
},
asciimath2jax: {
  delimiters: [["\\$", "\\$"]],
  ignoreClass: "nostem|noasciimath"
},
TeX: { equationNumbers: { autoNumber: "none" } }
});</script><script src="Spark%20Programming%20Training_files/MathJax.js"></script><!--Printing and PDF exports--><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.9.2/css/print/pdf.css" : "https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.9.2/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><link rel="stylesheet" type="text/css" href="Spark%20Programming%20Training_files/paper.css"><link rel="stylesheet" href="Spark%20Programming%20Training_files/custom_spk.css"><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="Spark%20Programming%20Training_files/all.min_002.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><script type="text/javascript" src="Spark%20Programming%20Training_files/zoom.js"></script><script type="text/javascript" src="Spark%20Programming%20Training_files/notes.js"></script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body style="transition: transform 0.8s ease 0s;"><div id="MathJax_Message" style="display: none;"></div><div class="reveal slide center has-vertical-slides has-horizontal-slides ready" role="application" data-transition-speed="default" data-background-transition="fade" style="cursor: none;"><div class="slides" style="width: 1920px; height: 1080px; inset: 50% auto auto 50%; transform: translate(-50%, -50%) scale(0.45);"><header>
  <img src="Spark%20Programming%20Training_files/LOGOFichier-7.png">
  <img src="Spark%20Programming%20Training_files/Apache_Spark_logo.svg">
</header><section class="title present" data-state="title" data-transition="fade" data-transition-speed="fast" style="top: 293px; display: block;"><h1>Spark Programming Training</h1><div class="preamble"><div class="paragraph"><p>08-10 Mars 2023</p></div></div><p class="author"><small>Amine HADJ-YOUCEF. PhD</small></p></section>
<section style="top: 0px; display: block;" class="stack future" data-previous-indexv="0" aria-hidden="true" hidden=""><section id="_introduction_to_the_training" style="top: 330.5px; display: none;" class="past" aria-hidden="true" hidden=""><h2>Introduction to the training</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/5361774.png" alt="5361774" height="200"></span></p></div></div></section><section id="_contents" class="columns is-vcentered past" style="top: 254.5px; display: none;" aria-hidden="true" hidden=""><h2>Contents</h2><div class="slide-content"><div class="ulist column"><ul><li><p>Round table</p></li><li><p>Training schedule</p></li><li><p>Objective of the training</p></li><li><p>Training program in detail</p></li><li><p>Training material</p></li></ul></div>
<div class="paragraph column"><p><span class="image"><img src="Spark%20Programming%20Training_files/1236506.png" alt="1236506" height="200"></span></p></div></div></section><section id="_round_table" class="columns is-vcentered past" style="top: 111.5px; display: none;" aria-hidden="true" hidden=""><h2>Round table</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/photo_linkedin_2020.png" alt="photo linkedin 2020" height="300"></div>
<div class="paragraph"><p><a href="https://www.linkedin.com/in/aminehy/">Amine Hadj-Youcef</a></p></div>
<div class="paragraph"><p><a href="mailto:hadjyoucef.amine@gmail.com">hadjyoucef.amine@gmail.com</a></p></div>
<div class="paragraph"><p><span class="image left"><img src="Spark%20Programming%20Training_files/Logo_Universit%C3%A9_Paris-Saclay.svg" alt="Logo Universit%C3%A9 Paris Saclay" height="100"></span>
<span class="image left"><img src="Spark%20Programming%20Training_files/LogoCS.png" alt="LogoCS" height="100"></span></p></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Data Science &amp; AI Consultant</p><div class="paragraph"><p><span class="image left"><img src="Spark%20Programming%20Training_files/Logo_SNCF_R%C3%A9seau_2015.svg" alt="Logo SNCF R%C3%A9seau 2015" height="100"></span>
<span class="image center"><img src="Spark%20Programming%20Training_files/1200px-TAG_Heuer_logo.svg.png" alt="1200px TAG Heuer logo.svg" height="100"></span>
<span class="image center"><img src="Spark%20Programming%20Training_files/logo_dronevolt_menu.svg" alt="logo dronevolt menu" height="100"></span>
<span class="image center"><img src="Spark%20Programming%20Training_files/logoias.jpg" alt="logoias" height="100"></span></p></div></li><li><p>Professional Mentor and Trainer</p><div class="paragraph"><p><span class="image left"><img src="Spark%20Programming%20Training_files/Atos_Origin_2011_logo.svg.png" alt="640px Atos Origin 2011 logo.svg" height="100"></span>
<span class="image left"><img src="Spark%20Programming%20Training_files/TF1_logo_2006.svg" alt="TF1 logo 2006" height="100"></span>
<span class="image left"><img src="Spark%20Programming%20Training_files/Logo_Bouygues_Immobilier.png" alt="Logo Bouygues Immobilier" height="100"></span>
<span class="image left"><img src="Spark%20Programming%20Training_files/lucy-in-the-cloud-logo.png" alt="lucy in the cloud logo" height="100"></span>
<span class="image left"><img src="Spark%20Programming%20Training_files/2ca6c8d907e76428a30ce6b4aad8f6a6.jpg" alt="2ca6c8d907e76428a30ce6b4aad8f6a6" height="100"></span>
<span class="image left"><img src="Spark%20Programming%20Training_files/Decathlon_Logo.svg.png" alt="640px Decathlon Logo.svg" height="100"></span></p></div></li></ul></div></div></div></div></section><section id="_round_table_name_job_title_experience_using_spark" class="columns past" style="top: 139.5px; display: block;" aria-hidden="true" hidden=""><h2>Round table: Name, Job title, Experience using spark</h2><div class="slide-content"><div class="ulist column"><ul><li><p>Sasha SKLYARENKO</p></li><li><p>Serena ZOU</p></li><li><p>Muhammad SAAD</p></li><li><p>Bahman SHEIKH</p></li><li><p>Jiachen HUANG</p></li><li><p>Tushar DESAI</p></li><li><p>Heemany SHEKHAR</p></li></ul></div>
<div class="ulist column"><ul><li><p>Jorge RODRIGUEZ CARDOZO</p></li><li><p>Anthony DITUSA</p></li><li><p>Matthew ALIBER</p></li><li><p>Guillaume SAJUST DE BERGUES</p></li><li><p>Gabriele CORNI</p></li><li><p>Juan GONZALEZ</p></li></ul></div>
<div class="paragraph column is-one-quarter"><p><span class="image"><img src="Spark%20Programming%20Training_files/pexels-photo-3183183.jpeg" alt="pexels photo 3183183"></span></p></div></div></section><section id="_training_schedule" class="" style="top: 294px; display: block;" aria-hidden="true"><h2>Training schedule</h2><div class="slide-content"><table class="tableblock frame-all grid-all" style="width:70%"><colgroup><col style="width:40%"><col style="width:30%"><col style="width:30%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p><strong>Wednesday</strong></p></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">March 7, 2023</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">3PM - 7PM (Paris)</p></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p><strong>Thursday</strong></p></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">March 8, 2023</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">3PM - 7PM</p></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p><strong>Friday</strong></p></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">March 9, 2023</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">3PM - 7PM</p></td></tr></tbody></table></div></section><section id="_objective_of_the_training" class="future" style="top: 341px; display: block;" aria-hidden="true" hidden=""><h2>Objective of the training</h2><div class="slide-content"><div class="ulist"><ul><li><p>Identify the main features of <strong>Spark</strong></p></li><li><p>Describe how <strong>DataFrames</strong> are created and evaluated in Spark</p></li><li><p>Apply DataFrame transformations to process and analyze data</p></li></ul></div></div></section><section id="_training_material" class="columns is-vcentered future" style="top: 63.5px; display: none;" aria-hidden="true" hidden=""><h2>Training material</h2><div class="slide-content"><div class="ulist column"><ul><li><p>Tools</p><div class="ulist"><ul><li><p>Python, Jupyter Notebooks…​</p></li></ul></div></li><li><p>Communication</p><div class="ulist"><ul><li><p>Zoom &amp; Slack</p></li></ul></div></li></ul></div>
<div class="paragraph column"><p><span class="image"><img src="Spark%20Programming%20Training_files/apache_spark-ar21.svg" alt="apache spark ar21" width="alt" height="200"></span>
<span class="image"><img src="Spark%20Programming%20Training_files/python-official.svg" alt="python official" width="alt" height="150"></span>
<span class="image"><img src="Spark%20Programming%20Training_files/numpy-ar21.svg" alt="numpy ar21" width="alt" height="200"></span>
<span class="image"><img src="Spark%20Programming%20Training_files/jupyter-ar21.svg" alt="jupyter ar21" width="alt" height="200"></span>
<span class="image"><img src="Spark%20Programming%20Training_files/5969059.png" alt="5969059" height="200"></span></p></div></div></section><section id="_training_material_2" class="future" style="top: 378.5px; display: none;" aria-hidden="true" hidden=""><h2>Training material</h2><div class="slide-content"><div class="ulist"><ul><li><p>All the slides</p></li><li><p>Jupyter Notebooks Python + Docker image</p></li></ul></div></div></section><section id="_questions" class="future" style="top: 463px; display: none;" aria-hidden="true" hidden=""><h2>Questions ?</h2></section></section>
<section style="top: 0px; display: block;" class="stack future" data-previous-indexv="0" aria-hidden="true" hidden=""><section id="_apache_spark" style="top: 330.5px; display: block;" class="" aria-hidden="true"><h2>Apache Spark</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/apache_spark-ar21.svg" alt="apache spark ar21" width="alt" height="200"></span></p></div></div></section><section id="_contents_2" class="columns is-vcentered future" aria-hidden="true" style="top: 105px; display: none;" hidden=""><h2>Contents</h2><div class="slide-content"><div class="ulist column"><ul><li><p>Apache Spark™</p></li><li><p>Architecture of Spark</p></li><li><p>Spark components and APIs</p></li><li><p>Transformations, Actions, and lazy evaluations</p></li><li><p>Quiz</p></li><li><p>Interaction with Spark</p></li><li><p>Spark Demo</p></li><li><p>Practical session</p></li><li><p>Resources</p></li></ul></div>
<div class="paragraph column"><p><span class="image"><img src="Spark%20Programming%20Training_files/1236506.png" alt="1236506" height="200"></span></p></div></div></section></section>
<section style="top: 0px; display: none;" class="stack future" data-previous-indexv="0" aria-hidden="true" hidden=""><section id="_apache_spark_2" class="columns is-vcentered" style="top: 308.5px; display: none;" aria-hidden="true"><h2>Apache Spark™</h2><div class="slide-content"><div class="paragraph column"><p><a href="https://spark.apache.org/">Apache Spark™</a>
 is a multi-language (Python, SQL, Scala, Java, R) engine for performing
 data engineering, data science and machine learning on single-node 
machines or clusters.</p></div><div class="paragraph column is-one-third"><p><span class="image"><img src="Spark%20Programming%20Training_files/apache_spark-ar21.svg" alt="apache spark ar21" width="alt" height="200"></span></p></div></div></section><section id="_apache_spark_3" class="future" aria-hidden="true" style="top: 202px; display: none;" hidden=""><h2>Apache Spark™</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>Spark</strong> offers in-memory storage for intermediate calculations, which makes it much faster than <strong>Hadoop MapReduce</strong>.</p></li><li><p>It incorporates libraries with combinable APIs</p><div class="ulist"><ul><li><p><strong>MLlib</strong>: machine learning</p></li><li><p><strong>Spark SQL</strong>: SQL for interactive queries</p></li><li><p><strong>Structured Streaming</strong>: stream processing to interact with data in real time</p></li><li><p><strong>GraphX</strong>: graph processing</p></li></ul></div></li></ul></div></div></section><section id="_apache_spark_vs_hadoop_map_reduce" class="future" aria-hidden="true" style="top: 246px; display: none;" hidden=""><h2>Apache Spark vs Hadoop Map Reduce</h2><div class="slide-content"><div class="ulist"><ul><li><p>Disadvantage of <code>Hadoop MapReduce</code></p><div class="olist arabic"><ol class="arabic"><li><p>Results are written to disk (fault tolerance) after each <code>MapReduce</code> operation and writing to disk is very slow</p></li><li><p>The expressions composed exclusively of <code>Map</code> and <code>Reduce</code>.e.i., limited, and not very expressive</p></li></ol></div></li><li><p><strong>Apache Spark</strong> is an alternative to <strong>Hadoop MapReduce</strong> for distributed computing that aims to solve both of these problems.</p></li></ul></div></div></section><section id="_apache_spark_vs_hadoop_map_reduce_2" class="future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Apache Spark vs. Hadoop Map Reduce</h2><div class="slide-content"><div class="ulist"><ul><li><p>Data on <strong>Spark</strong> is stored in memory ⇒ 10 to 100 times more
speed / Hadoop Map Reduce</p><table class="tableblock frame-none grid-none" style="width:60%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Technology</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">latency</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">SSD</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>1st-4</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">RAM (DDR3)</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>1st-8</p></div></div></td></tr></tbody></table></li><li><p><strong>Spark</strong> expands the map/reduce framework by providing distributed operations.</p></li><li><p>All distributed computation is done as <code>Map</code>/<code>Reduce</code> operations</p></li></ul></div></div></section><section id="_apache_spark_vs_hadoop_mapreduce" class="future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Apache Spark vs. Hadoop MapReduce</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>Hadoop</strong> and <strong>Spark</strong> are two Big Data frameworks but do not have the same use</p><div class="ulist"><ul><li><p><strong>Hadoop</strong> is a distributed data storage and processing framework</p></li><li><p><strong>Spark</strong> is a data processing framework but it does not provide storage</p></li></ul></div></li><li><p>Hadoop and Spark can be used independently</p></li></ul></div></div></section><section id="_spark_history" class="columns is-vcentered future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Spark History</h2><div class="slide-content"><div class="openblock"><div class="content"><div class="ulist"><ul><li><p>Designed by <strong>Matei Zaharia</strong> in 2009 during his doctoral thesis at the University of California</p></li><li><p><strong>Spark</strong> is an open source distributed computing framework</p></li><li><p>Developed in <strong>Scala</strong></p></li><li><p>Version 1.0 was released in 2014</p></li><li><p>In July 2016, <strong>Apache Spark</strong> was upgraded to version 2.0</p></li></ul></div></div></div>
<div class="openblock"><div class="content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/th-2568894126.jpeg" alt="?u=https%3A%2F%2Ftse3.mm.bing.net%2Fth%3Fid%3DOIP" height="300"></span></p></div></div></div></div></section><section id="_spark_ecosystem" class="future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Spark Ecosystem</h2><div class="slide-content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-26-21-52-56.png_.png" alt="image 2023 01 26 21 52 56.png " height="600"></div></div></section><section id="_advantages_of_spark" class="future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Advantages of Spark?</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>Speed</strong>: Allows applications in Hadoop to run 100x faster in memory and 10x faster on disk</p></li><li><p><strong>Ease of use</strong>: allows you to quickly write applications in Java, Scala and Python</p></li><li><p><strong>Advanced Analytics</strong>: Supports SQL queries, streaming data, and advanced analytics.</p></li></ul></div></div></section><section id="_features_of_spark" class="columns future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Features of Spark</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><strong>Fast</strong>: <strong>Spark</strong> is 100 times faster than <strong>Hadoop</strong></p></li><li><p><strong>Generic</strong></p><div class="ulist"><ul><li><p>Combines SQL, streaming and complex analytics.</p></li><li><p>Libraries: <strong>SQL</strong> and <strong>DataFrames</strong>, <strong>MLlib</strong>, <strong>GraphX</strong> and <strong>Spark Streaming</strong></p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><strong>Easy to use</strong></p><div class="listingblock"><div class="title">Python</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">df = spark.read.json(<span class="hljs-string"><span class="hljs-string">"logs.json"</span></span>)
df.where(<span class="hljs-string"><span class="hljs-string">"age &gt;21"</span></span>).select(<span class="hljs-string"><span class="hljs-string">"name.first"</span></span>).show()</code></pre></div></div></li><li><p><strong>Works everywhere</strong></p><div class="ulist"><ul><li><p>Runs on <code>Hadoop</code>, <code>Apache Mesos</code>, <code>Kubernetes</code>, standalone or in the cloud.</p></li><li><p>Programming language: <code>Python</code>, <code>Java</code>, <code>Scala</code></p></li></ul></div></li></ul></div></div></div></div></section><section id="_overview" class="future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Overview</h2><div class="slide-content"><div class="ulist"><ul><li><p>Apache Spark <strong>clusters</strong> are groups of computers that are treated as a single computer and manage the execution of commands issued from notebooks.</p></li><li><p>Clusters allow data to be processed on multiple computers to improve scaling and performance.</p></li><li><p>They consist of Spark <strong>Driver</strong> and <strong>Worker</strong> <strong>nodes</strong>.</p><div class="ulist"><ul><li><p>The <strong>driver node</strong> sends a job to the <strong>worker nodes</strong>* and asks them to fetch data from a specified data source.</p></li></ul></div></li></ul></div></div></section><section id="_overview_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Overview</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><strong>Spark</strong> connect to a wide variety of data sources</p><div class="ulist"><ul><li><p>Databases: <strong>Postgres</strong>, <strong>SQL Server</strong>, <strong>MySQL</strong></p></li><li><p>Message brokers like <strong>Kafka</strong> and <strong>Kinesis</strong></p></li><li><p>Distributed databases <strong>Cassandra</strong> and <strong>Redshift</strong></p></li><li><p>Data warehouses like <strong>Hive</strong></p></li><li><p>File types such as <strong>CSV</strong>, <strong>Parquet</strong> and <strong>Delta</strong></p></li></ul></div></li></ul></div></div></div>
<div class="imageblock column"><img src="Spark%20Programming%20Training_files/spark_databricks.png" alt="spark databricks"></div></div></section><section id="_use_cases_from_spark" class="future" aria-hidden="true" style="top: 540px; display: none;" hidden=""><h2>Use cases from Spark</h2><div class="slide-content"><div class="ulist"><ul><li><p>Parallel processing of large datasets distributed across a cluster</p></li><li><p>Perform interactive queries to explore and visualize datasets</p></li><li><p>Build, train and evaluate Machine Learning models using MLlib</p></li><li><p>Setting up end-to-end data pipelines from multiple data streams</p></li><li><p>Analysis of graph and social network datasets</p></li></ul></div></div></section></section>
<section style="top: 0px; display: none;" class="stack future" data-previous-indexv="0" aria-hidden="true" hidden=""><section id="_architecture_of_spark" style="top: 330.5px; display: none;" class="past" aria-hidden="true" hidden=""><h2>Architecture of Spark</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/1317487.png" alt="1317487" height="200"></span></p></div></div></section><section id="_architecture_of_spark_2" class="past" style="top: 143px; display: none;" aria-hidden="true" hidden=""><h2>Architecture of Spark</h2><div class="slide-content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-00-05-42.png_.png" alt="image 2023 01 27 00 05 42.png " height="500"></div>
<div class="paragraph"><p><a href="https://databricks.com/blog/2016/08/15/how-to-use-sparksession-in-apache-spark-2-0.html">How to use SparkSession in Apache Spark 2.0</a></p></div></div></section><section id="_architecture" class="past" style="top: 275.5px; display: none;" aria-hidden="true" hidden=""><h2>Architecture</h2><div class="slide-content"><div class="ulist"><ul><li><p>A <strong>driver</strong> master machine listens to client processing requests, cuts out each processing and delegates its execution to workers machines</p></li><li><p>This is the <strong>driver</strong> that executes the <code>main</code> method of our applications</p></li><li><p>The  <strong>workers</strong> machines will perform the requested work in parallel.</p></li><li><p>a <strong>Cluster Manager</strong> is responsible for instantiating the different workers</p></li></ul></div></div></section><section id="_spark_driver" class="past" style="top: 212px; display: none;" aria-hidden="true" hidden=""><h2>Spark Driver</h2><div class="slide-content"><div class="ulist"><ul><li><p>As the part of the Spark application responsible for instantiating a <strong>Spark Session</strong>, the <strong>Spark Driver</strong> has several roles:</p><div class="ulist"><ul><li><p>It communicates with the cluster manager</p></li><li><p>It requests resources (CPU, memory, etc.) from the cluster manager for Spark executors (JVMs)</p></li><li><p>It
 transforms all Spark operations into DAG computations, schedules them 
and distributes their execution as tasks across Spark executors</p></li><li><p>Once the resources are allocated, it communicates directly with the executors.</p></li></ul></div></li></ul></div></div></section><section id="_sparksession" class="past" style="top: 313.5px; display: none;" aria-hidden="true" hidden=""><h2>SparkSession</h2><div class="slide-content"><div class="ulist"><ul><li><p>In Spark 2.0, <strong>SparkSession</strong> became a unified conduit for all Spark operations and data.</p></li><li><p>It not only replaced previous Spark entry points such as <strong>SparkContext</strong>, <strong>SQLContext</strong>, <strong>HiveContext</strong>, <strong>SparkConf</strong> and <strong>StreamingContext</strong></p></li><li><p>It also made working with Spark simpler and easier.</p></li></ul></div></div></section><section id="_cluster_manager" class="past" style="top: 276.5px; display: none;" aria-hidden="true" hidden=""><h2>Cluster manager</h2><div class="slide-content"><div class="ulist"><ul><li><p>The cluster manager is responsible for <strong>management</strong> and <strong>resource allocation</strong> for the cluster of nodes on which Spark applications run.</p></li><li><p>Currently, Spark supports four cluster managers:</p><div class="ulist"><ul><li><p>The built-in standalone cluster manager
<strong>Apache Hadoop YARN
</strong>Apache Mesos</p></li><li><p>Kubernetes.</p></li></ul></div></li></ul></div></div></section><section id="_spark_executor" class="" style="top: 341px; display: none;" aria-hidden="true"><h2>Spark Executor</h2><div class="slide-content"><div class="ulist"><ul><li><p>A Spark executor runs on each <strong>worker</strong> node in the cluster.</p></li><li><p>Executors communicate with the <strong>driver</strong> and are responsible for executing tasks on the <strong>workers</strong>.</p></li><li><p>In most deployment modes, only one executor runs per node.</p></li></ul></div></div></section></section>
<section style="top: 0px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_spark_components_and_apis" style="top: 330.5px; display: none;"><h2>Spark components and APIs</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/3159355.png" alt="3159355" height="200"></span></p></div></div></section><section id="_spark_components_and_apis_2" class="future" aria-hidden="true" style="top: 232.5px; display: none;"><h2>Spark components and APIs</h2><div class="slide-content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-26-22-19-35.png_.png" alt="image 2023 01 26 22 19 35.png "></div></div></section><section id="_spark_core" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark Core</h2><div class="slide-content"><table class="tableblock frame-none grid-none" style="width:95%"><colgroup><col style="width:60%"><col style="width:40%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p><a href="https://spark.apache.org/docs/3.1.1/api/python/reference/pyspark.html">Spark core</a> contains core functionality for <strong>Spark</strong></p><div class="ulist"><ul><li><p>Task Scheduling
**Memory Management</p></li><li><p>Fault Recovery</p></li><li><p>Interaction with different storage types and data types</p></li><li><p>RDD manipulation APIs in <code>Scala</code> / <code>Python</code> / <code>Java</code></p></li></ul></div></li></ul></div></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/spark_core.png" alt="spark core"></span></p></div></div></td></tr></tbody></table></div></section><section id="_spark_sql_and_dataframe" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark SQL and DataFrame</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://spark.apache.org/docs/latest/sql-programming-guide.html">Spark SQL and Dataframe</a> works well with structured data.</p></li><li><p>You can read data from file formats with structured data (CSV, text, JSON, Avro, ORC, Parquet, etc.)</p></li><li><p>Allows building permanent or temporary tables in Spark.</p></li><li><p>Using
 Spark’s Structured APIs (in Java, Python, Scala, or R), you can combine
 SQL-like queries to query data read from a Spark DataFrame.</p></li></ul></div></div></section><section id="_spark_sql_and_dataframe_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark SQL and DataFrame</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Spark SQL is a structured data processing module with several interfaces.</p></li><li><p>We can interact with Spark SQL in two ways:</p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Execute SQL queries</p><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-sql hljs" data-noescape="true" data-lang="sql">%sql
<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, price
<span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> products
<span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> price &lt; <span class="hljs-number"><span class="hljs-number">200</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> price</code></pre></div></div></li><li><p>Work with DataFrame API.</p><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">spark.table(<span class="hljs-string"><span class="hljs-string">"products"</span></span>)
   .select(<span class="hljs-string"><span class="hljs-string">"name"</span></span>, <span class="hljs-string"><span class="hljs-string">"price"</span></span>)
   .where(<span class="hljs-string"><span class="hljs-string">"price &lt; 200"</span></span>)
   .orderBy(<span class="hljs-string"><span class="hljs-string">"price"</span></span>)</code></pre></div></div></li></ul></div></div></div></div></section><section id="_spark_sql_and_dataframe_conversion" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark SQL and DataFrame: Conversion</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><strong>createOrReplaceTempView</strong> creates a temporary view based on the DataFrame.</p></li><li><p>The lifetime of the temporary view is tied to the <strong>SparkSession</strong> that was used to create the DataFrame.</p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="title">DataFrame to SQL</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">df.createOrReplaceTempView(<span class="hljs-string"><span class="hljs-string">"budget"</span></span>)</code></pre></div></div>
<div class="listingblock"><div class="title">SQL to DataFrame</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">spark.sql(<span class="hljs-string"><span class="hljs-string">"SELECT * FROM budget"</span></span>)
<span class="hljs-comment"><span class="hljs-comment"># gold</span></span>
spark.table(<span class="hljs-string"><span class="hljs-string">"budget"</span></span>)</code></pre></div></div></div></div></div></section><section id="_example_of_dataframe_and_column_operators" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Example of DataFrame and Column operators</h2><div class="slide-content"><div class="listingblock"><div class="title">DataFrame and Column Operators</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">revDF = (eventsDF
          .filter(col(<span class="hljs-string"><span class="hljs-string">"ecommerce.purchase_revenue_in_usd"</span></span>).isNotNull())
          .withColumn(<span class="hljs-string"><span class="hljs-string">"purchase_revenue"</span></span>, (col(<span class="hljs-string"><span class="hljs-string">"ecommerce.purchase_revenue_in_usd"</span></span>) * <span class="hljs-number"><span class="hljs-number">100</span></span>).cast(<span class="hljs-string"><span class="hljs-string">"int"</span></span>))
          .withColumn(<span class="hljs-string"><span class="hljs-string">"avg_purchase_revenue"</span></span>, col(<span class="hljs-string"><span class="hljs-string">"ecommerce.purchase_revenue_in_usd"</span></span>) / col(<span class="hljs-string"><span class="hljs-string">"ecommerce.total_item_quantity"</span></span>))
          .sort(col(<span class="hljs-string"><span class="hljs-string">"avg_purchase_revenue"</span></span>).desc())
         )</code></pre></div></div></div></section><section id="_spark_pandas_api" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark pandas API</h2><div class="slide-content"><div class="ulist"><ul><li><p>Spark’s pandas API helps scale pandas workload</p><div class="ulist"><ul><li><p>Be <strong>immediately productive</strong> with <strong>Spark</strong>, if you are already familiar with <strong>pandas</strong>.</p></li><li><p>Have <strong>one code</strong> that works with both pandas (tests, small datasets) and Spark (distributed datasets).</p></li><li><p>Easily switch between <strong>pandas</strong> API and <strong>PySpark</strong> API context without any overhead.</p></li></ul></div></li></ul></div>
<div class="listingblock"><div class="title">Create a Pyspark Dataframe from a pandas Dataframe</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">pandas_df = pd.DataFrame({
     <span class="hljs-string"><span class="hljs-string">'a'</span></span>: [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>],
     <span class="hljs-string"><span class="hljs-string">'b'</span></span>: [<span class="hljs-number"><span class="hljs-number">2.</span></span>, <span class="hljs-number"><span class="hljs-number">3.</span></span>, <span class="hljs-number"><span class="hljs-number">4.</span></span>],
     <span class="hljs-string"><span class="hljs-string">'c'</span></span>: [<span class="hljs-string"><span class="hljs-string">'string1'</span></span>, <span class="hljs-string"><span class="hljs-string">'string2'</span></span>, <span class="hljs-string"><span class="hljs-string">'string3'</span></span>],
     <span class="hljs-string"><span class="hljs-string">'d'</span></span>: [date(<span class="hljs-number"><span class="hljs-number">2000</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), date(<span class="hljs-number"><span class="hljs-number">2000</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), date(<span class="hljs-number"><span class="hljs-number">2000</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)],
     <span class="hljs-string"><span class="hljs-string">'e'</span></span>: [datetime(<span class="hljs-number"><span class="hljs-number">2000</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), datetime(<span class="hljs-number"><span class="hljs-number">2000</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), datetime(<span class="hljs-number"><span class="hljs-number">2000</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)]
})
df = spark.createDataFrame(pandas_df)
df</code></pre></div></div></div></section><section id="_spark_mllib" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark MLlib</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>MLlib provides ML algorithms built on DataFrame based APIs (Classification, Regression, Clustering, PCA).</p></li><li><p>These APIs allow you to <strong>extract</strong> or <strong>transform</strong> features, <strong>build</strong> pipelines (for learning and evaluation)</p></li><li><p>MLlib includes other low-level ML primitives, including gradient descent</p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="title">Logistics regression</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.ml.classification <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LogisticRegression
...
<span class="hljs-comment"><span class="hljs-comment"># Load training / test data</span></span>
training = spark.read.csv(<span class="hljs-string"><span class="hljs-string">"s3://..."</span></span>)
test = spark.read.csv(<span class="hljs-string"><span class="hljs-string">"s3://..."</span></span>)


<span class="hljs-comment"><span class="hljs-comment"># Fit the model</span></span>
lr = LogisticRegression(maxIter=<span class="hljs-number"><span class="hljs-number">10</span></span>, regParam=<span class="hljs-number"><span class="hljs-number">0.3</span></span>, elasticNetParam=<span class="hljs-number"><span class="hljs-number">0.8</span></span>)
lrModel = lr.fit(training)

<span class="hljs-comment"><span class="hljs-comment"># Predict</span></span>
lrModel.transform(test)</code></pre></div></div></div></div></div></section><section id="_spark_structured_streaming" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark Structured Streaming</h2><div class="slide-content"><div class="ulist column"><ul><li><p><strong>Spark Streaming</strong> is used for <strong>real-time processing of streaming data</strong>.</p><div class="ulist"><ul><li><p>It is based on a "micro batch" processing mode</p></li><li><p>It uses for real-time data <code>DStream</code>, i.e. a series of <code>RDD</code> (Resilient Distributed Dataset).</p></li></ul></div></li></ul></div>
<div class="openblock column is-one-third"><div class="content"><div class="listingblock"><div class="title">Stream playback</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">lines = (spark
.readStream
.format(<span class="hljs-string"><span class="hljs-string">"socket"</span></span>)
.option(<span class="hljs-string"><span class="hljs-string">"host"</span></span>, <span class="hljs-string"><span class="hljs-string">"localhost"</span></span>)
.option(<span class="hljs-string"><span class="hljs-string">"port"</span></span>, <span class="hljs-number"><span class="hljs-number">9999</span></span>)
.load())</code></pre></div></div></div></div></div></section><section id="_graphx" class="columns is-vcentered future" aria-hidden="true" style="top: 540px; display: none;"><h2>GraphX</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><strong>GraphX</strong> is a library for manipulating graphs (e.g. social network graphs, routes and connection points, or network topology graphs)</p></li><li><p>It allows parallel calculations of graphs.</p></li><li><p>It offers standard graph algorithms for analysis, connections and traversals, contributed by community users.</p></li><li><p>Available algorithms include PageRank, Connected Components and Triangle Count.</p></li></ul></div></div></div>
<div class="paragraph column is-one-third"><p><span class="image"><img src="Spark%20Programming%20Training_files/spark_core.png" alt="spark core" height="300"></span></p></div></div></section></section>
<section style="top: 0px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_transformations_actions_and_lazy_evaluations" class="columns is-vcentered" style="top: 180px; display: none;"><h2>Transformations, Actions, and lazy evaluations</h2><div class="slide-content"><div class="ulist column"><ul><li><p>Spark’s operations on distributed data can be categorized into two types: <strong>transformations</strong> and <strong>actions</strong>.</p><div class="ulist"><ul><li><p><strong>Transformations</strong> transform a <strong>Spark DataFrame</strong> into a new DataFrame <strong>without altering the original data</strong>, giving it the property of immutability (e.g., select() or filter())</p></li><li><p>An <strong>action</strong> triggers lazy evaluation of all registered transformations.</p></li></ul></div></li></ul></div><div class="openblock column is-one-third"><div class="content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-00-54-22.png_.png" alt="image 2023 01 27 00 54 22.png "></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.sql.functions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> when

bonus_df = df.select(<span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-string"><span class="hljs-string">"Salary"</span></span>)\
            .withColumn(<span class="hljs-string"><span class="hljs-string">"Bonus"</span></span>,
                         when(df.Salary &gt; <span class="hljs-number"><span class="hljs-number">90000</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span> * df.Salary)
                         .otherwise(<span class="hljs-number"><span class="hljs-number">0</span></span>))</code></pre></div></div></div></div></div></section><section id="_dataframe_transformation_methods" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>DataFrame transformation methods</h2><div class="slide-content"><table class="tableblock frame-none grid-none" style="width:90%"><colgroup><col style="width:30%"><col style="width:70%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">select</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a new DataFrame by calculating the given expression for each
element</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">drop</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a new DataFrame with a column removed</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">withColumnRenamed</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a new DataFrame with a renamed column</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">withColumn</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a new DataFrame adding a column or replacing the
existing column with the same name</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">filter, where</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Filter rows using given condition</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">sort, orderBy</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a new DataFrame sorted by the given expressions</p></td></tr></tbody></table></div></section><section id="_dataframe_transformation_methods_2" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>DataFrame transformation methods</h2><div class="slide-content"><table class="tableblock frame-none grid-none" style="width:90%"><colgroup><col style="width:30%"><col style="width:70%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">dropDuplicates, distinct</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a new DataFrame with duplicate rows
deleted</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a new DataFrame taking the first n rows</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">groupBy</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Groups the DataFrame using the specified columns, so we can
run aggregation on them</p></td></tr></tbody></table>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>strings = spark.read.text(<span class="hljs-string"><span class="hljs-string">"../README.md"</span></span>)
<span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>filtered = strings.filter(strings.value.contains(<span class="hljs-string"><span class="hljs-string">"Spark"</span></span>))
<span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>filtered.count()
<span class="hljs-number"><span class="hljs-number">20</span></span></code></pre></div></div></div></section><section id="_column_operators_and_methods" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Column Operators and Methods</h2><div class="slide-content"><table class="tableblock frame-none grid-none" style="width:90%"><colgroup><col style="width:25%"><col style="width:75%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">*, + , &lt;, &gt;=</th><th class="tableblock halign-left valign-top">Mathematical and comparison operators</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">==, !=</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Tests for equality and inequality (Scala operators are
<code>===</code> and <code>=!=</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">alias</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Give the column an alias</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">cast, astype</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Converts the column to a different data type</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">isNull, isNotNull, isNan</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Is null, is not null, is NaN</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">asc, desc</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Returns a sort expression based on order
ascending/descending column</p></td></tr></tbody></table>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.sql.functions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> col

col(<span class="hljs-string"><span class="hljs-string">"ecommerce.purchase_revenue_in_usd"</span></span>) + col(<span class="hljs-string"><span class="hljs-string">"ecommerce.total_item_quantity"</span></span>)

(col(<span class="hljs-string"><span class="hljs-string">"ecommerce.purchase_revenue_in_usd"</span></span>) * <span class="hljs-number"><span class="hljs-number">100</span></span>).cast(<span class="hljs-string"><span class="hljs-string">"int"</span></span>)</code></pre></div></div></div></section><section id="_user_defined_function_udf_1" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>User Defined Function (UDF) <sup class="footnote">[<span class="footnote" title="View footnote.">1</span>]</sup></h2><div class="slide-content"><div class="listingblock column"><div class="title">Create a UDF</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.sql.functions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> udf

<span class="hljs-comment"><span class="hljs-comment"># create a python function</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstLetterFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(email)</span></span></span><span class="hljs-function">:</span></span>
     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> email[<span class="hljs-number"><span class="hljs-number">0</span></span>]

<span class="hljs-comment"><span class="hljs-comment"># create a udf</span></span>
firstLetterUDF = udf(firstLetterFunction)</code></pre></div></div>
<div class="listingblock column"><div class="title">Apply the udf</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.sql.functions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> col

salesDF.select(firstLetterUDF(col(<span class="hljs-string"><span class="hljs-string">"email"</span></span>)))</code></pre></div></div></div><div class="footnotes"><div class="footnote">1. <a href="https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.sql.functions.udf.html" class="bare">spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.sql.functions.udf.html</a></div></div></section><section id="_rdd" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>RDD</h2><div class="slide-content"><div class="ulist"><ul><li><p><strong>RDD</strong> <sup class="footnote">[<span class="footnote" title="View footnote.">1</span>]</sup> is the central concept of the Spark framework</p><div class="ulist"><ul><li><p><strong>Resilient</strong>: In case of loss of a node, the subprocessing will be automatically restarted on another node</p></li><li><p><strong>Distributed</strong>: partitioned dataset and each of the partitions processed on a cluster node</p></li><li><p><strong>Dataset</strong>: dataset that can be browsed as a collection</p></li></ul></div></li></ul></div></div><div class="footnotes"><div class="footnote">1. <a href="https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.RDD.html#pyspark.RDD">Resilient Distributed Dataset</a></div></div></section><section id="_transformation_and_action" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Transformation and Action</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>RDD allows data manipulation with Spark and supports two types of operations</p><div class="ulist"><ul><li><p><strong>Transformations</strong></p></li><li><p><strong>The actions</strong></p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/rdd.png" alt="rdd"></span></p></div></div></div></div></section><section id="_rdd_transformations" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>RDD: Transformations</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><strong>Transformations</strong> do not return a result, they return a new <strong>RDD</strong></p><div class="ulist"><ul><li><p>Nothing is evaluated when calling a <strong>transformation</strong> function called “lazy” (i.e., they will only be executed if a final operation is performed at the end of the chain)</p></li></ul></div></li><li><p>This function just takes an RDD and returns a new RDD.</p></li></ul></div></div></div></div></section><section id="_rdd_transformations_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>RDD: Transformations</h2><div class="slide-content"><div class="openblock column is-two-thirds"><div class="content"><div class="ulist"><ul><li><p>The main functions of <strong>transformation</strong> are:</p><div class="ulist"><ul><li><p><strong>map()</strong> allows to transform an element into another element</p></li><li><p><strong>mapToPair</strong>() allows to transform an element into a key-value tuple</p></li><li><p><strong>filter</strong>() allows to filter the elements by keeping only those which correspond to an expression</p></li><li><p><strong>flatMap</strong>() allows to split an element into several other elements</p></li><li><p><strong>reduceByKey</strong>() allows elements to be aggregated together</p></li><li><p>…​</p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/rdd.png" alt="rdd" height="300"></span></p></div></div></div></div></section><section id="_rdd_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>RDD</h2><div class="slide-content"><div class="openblock column is-two-thirds"><div class="content"><div class="ulist"><ul><li><p>The <strong>actions</strong>: evaluate and return a new value.</p><div class="ulist"><ul><li><p>The moment an action function is called on an RDD object, the transformations needed to evaluate the action are computed</p></li></ul></div></li><li><p>The main actions are</p><div class="ulist"><ul><li><p><code>count()</code> and <code>countByKey()</code> allow to count the elements</p></li><li><p><code>collect()</code> allows to retrieve the elements in a collection</p></li><li><p><code>saveAsTextFile()</code> allows to save the result in text files</p></li><li><p><code>reduce()</code> allows to aggregate elements between them</p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>An intermediate result can be stored temporarily thanks to the methods</p><div class="ulist"><ul><li><p><code>cache()</code>: in-memory storage</p></li><li><p><code>persist()</code>: storage in memory or on disk</p></li></ul></div></li></ul></div>
<div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/rdd.png" alt="rdd" height="300"></span></p></div></div></div></div></section><section id="_transformation_vs_action" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Transformation vs Action</h2><div class="slide-content"><div class="ulist column"><ul><li><p>A <strong>transformation</strong> is a Spark operation that returns a DataFrame, Dataset, or RDD, performed lazily.</p></li></ul></div>
<div class="ulist column"><ul><li><p><strong>actions</strong>, on the other hand, are not performed lazily and produce value by performing all necessary transformations. You can use the <code>persist</code> or <code>cache</code> functions to avoid recalculating the values.</p></li></ul></div></div></section><section id="_rdd_data_sources" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>RDD: Data sources</h2><div class="slide-content"><div class="ulist"><ul><li><p>To create an RDD, one can load the data from several sources</p></li><li><p>A <strong>local</strong> or distributed file (HDFS) whose format is configurable: plain text, SequenceFile Hadoop, JSON, etc.</p></li><li><p>A <strong>database</strong>: JDBC, Cassandra, Hbase, etc.</p><div class="ulist"><ul><li><p>A <strong>collection</strong> (List, Set), transformed into an RDD with the parallelize operator</p></li><li><p>Another <strong>RDD</strong> to which a transformation has been applied
Etc.</p></li></ul></div></li></ul></div>
<div class="admonitionblock note"><table><tbody><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><div class="paragraph"><p>The reverse path, exporting an RDD to a file, to a database or to a collection is also possible</p></div></td></tr></tbody></table></div></div></section><section id="_reading_data" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Reading data</h2><div class="slide-content"><div class="ulist"><ul><li><p>Reading data is the responsibility of the <strong>SparkContext</strong></p><div class="ulist"><ul><li><p>The <strong>SparkContext</strong> outputs an <code>RDD</code></p></li><li><p><code><strong>sc.textFile(path)</strong></code> <sup class="footnote">[<span class="footnote" title="View footnote.">1</span>]</sup>: calling this method creates an RDD from the lines of the file. Note that the <code>path</code> of the file can be a network path, which will be useful later.</p></li><li><p><code><strong>sc.wholeTextFiles(path)</strong></code> <sup class="footnote">[<span class="footnote" title="View footnote.">2</span>]</sup>: <code>path</code>
 can designate a path to a file or a directory containing multiple 
files. The constructed RDD is a set of key-values where each key 
indicates the path to a file and the values are the complete contents of
 the files. The file(s) are therefore not broken down into lines.</p></li><li><p><code><strong>sc.parallelize(iterable)</strong></code> <sup class="footnote">[<span class="footnote" title="View footnote.">3</span>]</sup>: used to transform <code>Python</code> (or <code>Scala</code>) objects into RDD. parallelize is mainly used in the Spark Shell to debug applications.</p></li></ul></div></li></ul></div></div><div class="footnotes"><div class="footnote">1. <a href="https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.SparkContext.textFile.html#pyspark.SparkContext.textFile:">Doc: textFile </a></div><div class="footnote">2. <a href="https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.SparkContext.wholeTextFiles.html#pyspark.SparkContext.wholeTextFiles:">Doc: wholeTextFiles</a></div><div class="footnote">3. <a href="https://spark.apache.org/docs/3.1.1/api/python/reference/api/pyspark.SparkContext.parallelize.html#pyspark.SparkContext.parallelize:">Doc: parallelize</a></div></div></section><section id="_dataframe" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>DataFrame</h2><div class="slide-content"><div class="ulist column"><ul><li><p><code>DataFrame</code>: collection of distributed data, organized in columns.</p><div class="ulist"><ul><li><p><strong>DataFrame = RDD + named columns</strong></p></li></ul></div></li><li><p>Similar to a table in the world of relational databases.</p></li><li><p>Can be converted to RDD by calling the <code>rdd</code> method, which returns the contents of the DataFrame as an RDD of rows</p></li><li><p>The Dataset API is available for <code>Scala</code>, <code>Java</code>, <code>Python</code> and R.</p></li></ul></div>
<div class="ulist column"><ul><li><p>Can be created from different data sources:</p><div class="ulist"><ul><li><p>Existing RDDs</p></li><li><p>Structured data files</p></li><li><p>JSON Datasets</p></li><li><p>HIVE Tables</p></li><li><p>External databases</p></li></ul></div></li></ul></div></div></section><section id="_dataframe_and_column" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>DataFrame and Column</h2><div class="slide-content"><div class="ulist column"><ul><li><p>A <strong>DataFrame</strong> is a distributed collection of data grouped into named columns</p><div class="ulist"><ul><li><p>select, selectExpr, drop, withColumn, withColumnRenamed, filter, distinct, limit, sort</p></li></ul></div></li></ul></div>
<div class="ulist column"><ul><li><p>A <strong>column</strong> is a logical construct that will be calculated based on data from a DataFrame using an expression</p><div class="ulist"><ul><li><p>alias, isin, cast, isNotNull, desc, operators</p></li></ul></div></li></ul></div></div></section><section id="_pyspark" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>PySpark</h2><div class="slide-content"><div class="ulist column"><ul><li><p>PySpark is a frontend for <strong>Apache Spark</strong> in <strong>Python</strong></p><div class="ulist"><ul><li><p>Link between python API and Spark Core</p></li><li><p><strong>Python</strong> &gt; 3.6</p></li><li><p>Available from PiP or Conda (e.g., pip install pyspark)</p></li></ul></div></li></ul></div>
<div class="ulist column"><ul><li><p>Dependencies</p><div class="ulist"><ul><li><p>Pandas: 0.23.2 (Optional for SQL)</p></li><li><p>NumPy: 1.7 (Required for ML)</p></li><li><p>Pyarrow: 1.0.0 (Optional for SQL)</p></li><li><p>Py4J: 0.10.9 (Required)</p></li><li><p>Java 8 or recent with JAVA_HOME correctly defined</p></li></ul></div></li></ul></div></div></section></section>
<section style="top: 540px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_quiz" style="top: 540px; display: none;"><h2>Quiz</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/3406828.png" alt="3406828" height="200"></span></p></div></div></section><section id="_quiz_2" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz</h2><div class="slide-content"><div class="ulist"><ul><li><p>Which definition best describes Apache Spark?</p><div class="olist arabic"><ol class="arabic"><li><p>A highly scalable relational database management system.</p></li><li><p>A virtual server with a Python runtime.</p></li><li><p>A distributed platform for parallel data processing using multiple languages.</p></li></ol></div></li></ul></div></div></section><section id="_quiz_3" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz</h2><div class="slide-content"><div class="ulist"><ul><li><p>You must use Spark to analyze the data in a parquet file. What should you do ?</p><div class="olist arabic"><ol class="arabic"><li><p>Load the parquet file into a dataframe.</p></li><li><p>Import data into a table in a serverless SQL pool.</p></li><li><p>Export table data in CSV format.</p></li></ol></div></li></ul></div></div></section><section id="_quiz_4" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz</h2><div class="slide-content"><div class="ulist"><ul><li><p>Which magic command to use to write code in a notebook cell of an SQL query?</p><div class="olist arabic"><ol class="arabic"><li><p>%spark</p></li><li><p>%pyspark</p></li><li><p>%sql</p></li></ol></div></li></ul></div></div></section></section>
<section style="top: 540px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_interaction_with_spark" style="top: 540px; display: none;"><h2>Interaction with Spark</h2></section><section id="_interaction_with_spark_standalone" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Interaction with Spark: Standalone</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="paragraph"><p><a href="https://spark.apache.org/downloads.html">Download Apache Spark™</a></p></div>
<div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-01-25-54.png_.png" alt="image 2023 01 27 01 25 54.png "></div></div></div>
<div class="openblock column"><div class="content"><div class="paragraph"><p><a href="https://spark.apache.org/docs/latest/api/python/getting_started/install.html">pyspark installation</a></p></div>
<div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-01-26-13.png_.png" alt="image 2023 01 27 01 26 13.png "></div></div></div></div></section><section id="_interaction_with_spark_docker" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Interaction with Spark: Docker</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/5969059.png" alt="5969059" height="200"></span></p></div></div></section><section id="_interaction_with_spark_docker_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Interaction with Spark: Docker</h2><div class="slide-content"><div class="openblock column is-half"><div class="content"><div class="listingblock"><div class="title">Download <a href="https://hub.docker.com/r/jupyter/pyspark-notebook">jupyter/pyspark-notebook</a> and run pyspark</div><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-noescape="true" data-lang="bash">docker pull jupyter/pyspark-notebook

docker run -p 8888:8888 --rm -it -e JUPYTER_ENABLE_LAB=yes -v C:\datasicence\resource:/home/jovyan/work --name pyspark jupyter/pyspark-notebook

docker run -p 8888:8888 --rm -it -e JUPYTER_ENABLE_LAB=yes -v $(<span class="hljs-built_in"><span class="hljs-built_in">pwd</span></span>):/home/jovyan/work --name pyspark jupyter/pyspark-notebook</code></pre></div></div>
<div class="admonitionblock note"><table><tbody><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content"><div class="ulist"><ul><li><p>Make sure you already have installed <a href="https://docs.docker.com/get-docker/">Docker</a></p></li><li><p>Documentation: <a href="https://jupyter-docker-stacks.readthedocs.io/en/latest/using/selecting.html#jupyter-pyspark-notebook">jupyter-pyspark-notebook</a></p></li></ul></div></td></tr></tbody></table></div></div></div>
<div class="imageblock column is-half"><img src="Spark%20Programming%20Training_files/image_2023-01-30-16-09-03.png_.png" alt="image 2023 01 30 16 09 03.png "></div></div></section><section id="_interaction_with_spark_docker_run" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Interaction with Spark: Docker run</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-30-15-59-38.png_.png" alt="image 2023 01 30 15 59 38.png "></div><div class="title">Figure 1. docker pull jupyter/pyspark-notebook <sup class="footnote">[<span class="footnote" title="View footnote.">1</span>]</sup></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-30-16-00-29.png_.png" alt="image 2023 01 30 16 00 29.png "></div><div class="title">Figure 2. docker run -p 8888:8888 …​</div></div></div></div><div class="footnotes"><div class="footnote">1. <a href="https://docs.docker.com/get-started/docker_cheatsheet.pdf" class="bare">docs.docker.com/get-started/docker_cheatsheet.pdf</a></div></div></section><section id="_first_notebook" class="columns is-vcentered future" aria-hidden="true" style="top: 540px; display: none;"><h2>First Notebook</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Open Jupyter Lab on the browser by pasting the URL : <a href="http://127.0.0.1:8888/lab?token=4299596be64be" class="bare">127.0.0.1:8888/lab?token=4299596be64be</a>..</p></li><li><p>Write your first python code</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SparkConf, SparkContext
conf = SparkConf().setMaster(<span class="hljs-string"><span class="hljs-string">"local"</span></span>).setAppName(<span class="hljs-string"><span class="hljs-string">"My App"</span></span>)
sc = SparkContext(conf = conf)</code></pre></div></div></div></div>
<div class="imageblock column is-one-third"><img src="Spark%20Programming%20Training_files/image_2023-01-30-15-56-00.png_.png" alt="image 2023 01 30 15 56 00.png "></div></div></section><section id="_notes" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Notes</h2><div class="slide-content"><div class="admonitionblock warning"><table><tbody><tr><td class="icon"><i class="fa fa-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>It is risky to define several SparkContext, in this case use sc.stop() to stop a session before starting a new one.</p></div></td></tr></tbody></table></div>
<div class="admonitionblock important"><table><tbody><tr><td class="icon"><i class="fa fa-exclamation-circle" title="Important"></i></td><td class="content"><div class="title">Main differences</div><div class="ulist"><ul><li><p><code>Spark Context</code> must be set manually in the code</p></li><li><p>Need to link dependencies between <code>Spark</code> and the program (Java and <code>Scala</code>)</p></li><li><p><code>spark-submit</code> allows to execute the script</p></li></ul></div></td></tr></tbody></table></div></div></section><section id="_interaction_with_spark_databricks" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Interaction with Spark: Databricks</h2><div class="slide-content"><div class="ulist"><ul><li><p>Cloud solution integrating Spark: <a href="https://community.cloud.databricks.com/" class="bare">community.cloud.databricks.com/</a></p></li></ul></div>
<div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-01-04-55.png_.png" alt="image 2023 01 27 01 04 55.png " height="700"></div></div></section><section id="_interaction_with_spark_databricks_2" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Interaction with Spark: Databricks</h2><div class="slide-content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-01-06-02.png_.png" alt="image 2023 01 27 01 06 02.png " height="700"></div></div></section><section id="_interaction_with_spark_databricks_3" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Interaction with Spark: Databricks</h2><div class="slide-content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-01-09-01.png_.png" alt="image 2023 01 27 01 09 01.png " height="700"></div></div></section></section>
<section style="top: 540px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_spark_demo" style="top: 540px; display: none;"><h2>Spark Demo</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/2621303.png" alt="2621303" height="200"></span></p></div></div></section><section id="_handling_dataframes" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Handling DataFrames</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://mybinder.org/v2/gh/apache/spark/fbbcf9434a?filepath=python%2Fdocs%2Fsource%2Fgetting_started%2Fquickstart_df.ipynb">Quickstart DataFrame Notebook</a></p></li><li><p><a href="https://mybinder.org/v2/gh/apache/spark/fbbcf9434a?filepath=python%2Fdocs%2Fsource%2Fgetting_started%2Fquickstart_ps.ipynb">Quickstart: Pandas API on Spark</a></p></li></ul></div></div></section><section id="_reading_data_in_python" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Reading data in Python</h2><div class="slide-content"><div class="ulist"><ul><li><p>Link to an Airbnb parquet file: <a href="https://github.com/databricks/LearningSparkV2/tree/master/databricks-datasets/learning-spark-v2/sf-airbnb/sf-airbnb-clean.parquet"> sf-airbnb-clean.parquet</a></p></li></ul></div>
<div class="listingblock"><div class="title">Reading data in Python</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python">filePath = <span class="hljs-string"><span class="hljs-string">"/databricks-datasets/learning-spark-v2/sf-airbnb/sf-airbnb-clean.parquet/"</span></span>
airbnbDF = spark.read.parquet(filePath)

airbnbDF.select(<span class="hljs-string"><span class="hljs-string">"neighbourhood_cleansed"</span></span>, <span class="hljs-string"><span class="hljs-string">"room_type"</span></span>, <span class="hljs-string"><span class="hljs-string">"bedrooms"</span></span>, <span class="hljs-string"><span class="hljs-string">"bathrooms"</span></span>, <span class="hljs-string"><span class="hljs-string">"number_of_reviews"</span></span>, <span class="hljs-string"><span class="hljs-string">"price"</span></span>).show(<span class="hljs-number"><span class="hljs-number">5</span></span>)</code></pre></div></div></div></section><section id="_regression_logistic_with_pyspark" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Regression Logistic with PySpark</h2><div class="slide-content"><div class="listingblock"><div class="title">Regression in Python</div><div class="content"><pre class="highlightjs highlight"><code class="language-python hljs" data-noescape="true" data-lang="python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.ml.classification <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LogisticRegression

training = spark.read.csv(<span class="hljs-string"><span class="hljs-string">"s3://..."</span></span>)
test = spark.read.csv(<span class="hljs-string"><span class="hljs-string">"s3://..."</span></span>)
<span class="hljs-comment"><span class="hljs-comment"># Load training data</span></span>
lr = LogisticRegression(maxIter=<span class="hljs-number"><span class="hljs-number">10</span></span>, regParam=<span class="hljs-number"><span class="hljs-number">0.3</span></span>, elasticNetParam=<span class="hljs-number"><span class="hljs-number">0.8</span></span>)
<span class="hljs-comment"><span class="hljs-comment"># Fit the model</span></span>
lrModel = lr.fit(training)
<span class="hljs-comment"><span class="hljs-comment"># Predict</span></span>
lrModel.transform(test)</code></pre></div></div>
<div class="ulist"><ul><li><p><a href="https://learn.microsoft.com/fr-fr/azure/databricks/getting-started/dataframes-python" class="bare">learn.microsoft.com/fr-fr/azure/databricks/getting-started/dataframes-python</a></p></li><li><p><a href="https://learn.microsoft.com/fr-fr/azure/databricks/getting-started/free-training" class="bare">learn.microsoft.com/fr-fr/azure/databricks/getting-started/free-training</a></p></li></ul></div></div></section></section>
<section style="top: 540px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_practical_session" style="top: 540px; display: none;"><h2>Practical session</h2></section><section id="_programming_apache_spark" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Programming Apache Spark</h2><div class="slide-content"><div class="ulist"><ul><li><p>Databricks Academy</p><div class="ulist"><ul><li><p>via <strong>Databricks Repo</strong>: <a href="https://github.com/databricks-academy/apache-spark-programming-with-databricks.git" class="bare">github.com/databricks-academy/apache-spark-programming-with-databricks.git</a></p></li><li><p>or directly via <strong>Databricks Archive</strong>: <a href="https://github.com/databricks-academy/apache-spark-programming-with-databricks/releases/download/v2.2.9/apache-spark-programming-with-databricks-v2.2.9-notebooks.dbc">Programming Apache Spark with Databricks DBC</a></p></li></ul></div></li></ul></div></div></section><section id="_learn_spark" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Learn Spark</h2><div class="slide-content"><div class="ulist"><ul><li><p>Chapter 01-10: <a href="https://github.com/databricks/LearningSparkV2/blob/master/notebooks/LearningSparkv2.dbc">Learning Spark DBC</a></p></li></ul></div></div></section><section id="_ml_with_spark_in_databricks" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>ML with Spark in Databricks</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://files.training.databricks.com/classes/ml/ml-on-spark.dbc">Machine Learning on Spark DBC</a></p></li></ul></div>
<div class="imageblock"><img src="Spark%20Programming%20Training_files/image_2023-01-27-01-51-20.png_.png" alt="image 2023 01 27 01 51 20.png "></div></div></section><section id="_quickstart_to_machine_learning_training" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quickstart to Machine Learning training</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://learn.microsoft.com/en-us/azure/databricks/_extras/notebooks/source/mlflow/ml-quickstart-training.html">ml-quickstart-training</a></p></li></ul></div></div></section><section id="_hands_on_machine_learning_on_azure_databricks" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Hands-on: Machine Learning on Azure Databricks</h2><div class="slide-content"><div class="ulist"><ul><li><p><a href="https://github.com/MicrosoftLearning/dp-090-databricks-ml/raw/master/02%20-%20Training%20and%20Evaluating%20Machine%20Learning%20Models.dbc">Training and Evaluating Machine Learning DBC Models</a></p></li><li><p><a href="https://github.com/MicrosoftLearning/dp-090-databricks-ml/raw/master/03%20-%20Managing%20Experiments%20and%20Models.dbc">Managing Experiments and Models DBC</a></p></li><li><p><a href="https://github.com/MicrosoftLearning/dp-090-databricks-ml/raw/master/04%20-%20Integrating%20Azure%20Databricks%20and%20Azure%20Machine%20Learning.dbc">Integrating Azure Databricks and Azure Machine Learning DBC</a></p></li></ul></div></div></section></section>
<section style="top: 540px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_resources" style="top: 540px; display: none;"><h2>Resources</h2><div class="slide-content"><div class="imageblock"><img src="Spark%20Programming%20Training_files/4730789.png" alt="4730789" width="alt" height="200"></div></div></section><section id="_pyspark_cheat_sheet" class="columns is-vcentered future" aria-hidden="true" style="top: 540px; display: none;"><h2>PySpark Cheat Sheet</h2><div class="slide-content"><div class="paragraph column"><p><a href="https://cheatography.com/datacademy-ai/cheat-sheets/pyspark/">Pyspark Cheat Sheet</a></p></div>
<div class="imageblock column"><img src="Spark%20Programming%20Training_files/image_2023-03-08-01-13-30_.png" alt="image 2023 03 08 01 13 30 "></div></div></section><section id="_book_learning_spark" class="columns is-vcentered future" aria-hidden="true" style="top: 540px; display: none;"><h2>Book: Learning Spark</h2><div class="slide-content"><div class="paragraph column"><p><a href="https://www.amazon.fr/dp/1492050040?linkCode=gs2&amp;tag=oreilly2007-21">Download the book: Learning Spark</a></p></div>
<div class="imageblock column"><img src="Spark%20Programming%20Training_files/image_2023-01-26-21-46-22.png_.png" alt="image 2023 01 26 21 46 22.png " height="700"></div></div></section><section id="_exercises_from_the_book" class="columns is-vcentered future" aria-hidden="true" style="top: 540px; display: none;"><h2>Exercises from the book</h2><div class="slide-content"><div class="paragraph column"><p><a href="https://github.com/databricks/LearningSparkV2/tree/master/notebooks">Github: Notebooks</a></p></div>
<div class="imageblock column"><img src="Spark%20Programming%20Training_files/image_2023-01-26-21-47-46.png_.png" alt="image 2023 01 26 21 47 46.png " height="700"></div></div></section><section id="_spark_api_documentation" class="future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark API documentation</h2><div class="slide-content"><div class="ulist"><ul><li><p>Home Page
Spark’s <a href="https://spark.apache.org/docs/latest/">documentation</a> includes links to helpful API docs and guides for each version of Spark.</p></li><li><p><a href="https://spark.apache.org/docs/latest/api/scala/org/apache/spark/index.html">Scala API</a> and
<a href="https://spark.apache.org/%20docs/latest/api/python/index.html">Python APIs</a> are the most commonly used, and it’s often useful to
reference the documentation for both languages.</p></li><li><p>Scala docs tend to be more comprehensive and Python docs tend to have more code examples.</p></li></ul></div></div></section><section id="_spark_with_examples" class="columns is-vcentered future" aria-hidden="true" style="top: 540px; display: none;"><h2>Spark with examples</h2><div class="slide-content"><div class="paragraph column"><p><a href="https://sparkbyexamples.com/">sparkbyexamples.com</a></p></div>
<div class="imageblock column"><img src="Spark%20Programming%20Training_files/image_2023-01-27-01-28-49.png_.png" alt="image 2023 01 27 01 28 49.png "></div></div></section></section>
<section style="top: 540px; display: none;" aria-hidden="true" class="stack future" data-previous-indexv="0" hidden=""><section id="_more_quiz" style="top: 540px; display: none;"><h2>More Quiz</h2><div class="slide-content"><div class="paragraph"><p><span class="image"><img src="Spark%20Programming%20Training_files/3406828.png" alt="3406828" height="200"></span></p></div></div></section><section id="_quiz_1" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz 1</h2><div class="slide-content"><div class="ulist column"><ul><li><p>What is Apache Spark?</p><div class="olist arabic"><ol class="arabic"><li><p>An open-source, distributed computing system</p></li><li><p>A data storage system</p></li><li><p>A web browser</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>What does Spark Core provide?</p><div class="olist arabic"><ol class="arabic"><li><p>High-level APIs in Scala, Java, Python, and R</p></li><li><p>Support for tasks such as scheduling, distributing, and monitoring applications on a cluster</p></li><li><p>Both A and B</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>What is RDD in Spark?</p><div class="olist arabic"><ol class="arabic"><li><p>a. A traditional distributed dataset</p></li><li><p>b. An immutable, partitioned collection of elements that can be processed in parallel</p></li><li><p>c. A data storage system</p></li></ol></div></li></ul></div></div></section><section id="_quiz_1_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz 1</h2><div class="slide-content"><div class="ulist column"><ul><li><p>What is Spark Streaming used for?</p><div class="olist arabic"><ol class="arabic"><li><p>Processing batch data</p></li><li><p>Processing real-time data streams</p></li><li><p>Storing data</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>What is MLlib in Spark?</p><div class="olist arabic"><ol class="arabic"><li><p>A module for graph processing</p></li><li><p>A machine learning library</p></li><li><p>A data storage system</p></li></ol></div></li></ul></div></div></section><section id="_quiz_2_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz 2</h2><div class="slide-content"><div class="ulist column"><ul><li><p>What type of data can be processed with Spark Streaming?</p><div class="olist arabic"><ol class="arabic"><li><p>Batch data</p></li><li><p>Real-time data streams</p></li><li><p>Both A and B</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>Can Spark run on a single machine or does it require a cluster?</p><div class="olist arabic"><ol class="arabic"><li><p>Single machine</p></li><li><p>Cluster</p></li><li><p>Either a single machine or a cluster</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>What is Spark SQL used for?</p><div class="olist arabic"><ol class="arabic"><li><p>Processing structured data</p></li><li><p>Processing unstructured data</p></li><li><p>Storing data</p></li></ol></div></li></ul></div></div></section><section id="_quiz_2_3" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz 2</h2><div class="slide-content"><div class="ulist column"><ul><li><p>What is the purpose of GraphX in Spark?</p><div class="olist arabic"><ol class="arabic"><li><p>To process graph-structured data</p></li><li><p>To process tabular data</p></li><li><p>To store data</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>Does Spark support integration with other big data tools and systems?</p><div class="olist arabic"><ol class="arabic"><li><p>Yes</p></li><li><p>No</p></li><li><p>Only some tools and systems</p></li></ol></div></li></ul></div></div></section><section id="_quiz_3_2" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz 3</h2><div class="slide-content"><div class="ulist column"><ul><li><p>What type of data can Spark SQL handle?</p><div class="olist arabic"><ol class="arabic"><li><p>Structured data</p></li><li><p>Unstructured data</p></li><li><p>Both A and B</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>What is the main advantage of using Spark over Hadoop MapReduce?</p><div class="olist arabic"><ol class="arabic"><li><p>Faster processing</p></li><li><p>Easier to use</p></li><li><p>Both A and B</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>How does Spark support the processing of real-time data streams?</p><div class="olist arabic"><ol class="arabic"><li><p>By dividing the data into small batches and processing them in parallel</p></li><li><p>By storing the data in a traditional database</p></li><li><p>By processing the data in a single pass</p></li></ol></div></li></ul></div></div></section><section id="_quiz_3_3" class="columns future" aria-hidden="true" style="top: 540px; display: none;"><h2>Quiz 3</h2><div class="slide-content"><div class="ulist column"><ul><li><p>What is GraphX in Spark used for?</p><div class="olist arabic"><ol class="arabic"><li><p>Processing graph-structured data</p></li><li><p>Storing graph-structured data</p></li><li><p>Both A and B</p></li></ol></div></li></ul></div>
<div class="ulist column"><ul><li><p>Can Spark run on a single machine?</p><div class="olist arabic"><ol class="arabic"><li><p>Yes</p></li><li><p>No</p></li><li><p>It depends on the size of the data.</p></li></ol></div></li></ul></div></div></section></section><footer>
  <!-- <p>spark avec databricks, Copyright &copy; 2023 Amine HY</p> -->
  <p>Spark Programming Training, Copyright © 2023 Amine HY</p>
</footer></div><div class="backgrounds"><div class="slide-background title present" style="display: block;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background stack future" style="display: block;" data-loaded="true"><div class="slide-background-content"></div><div class="slide-background past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background columns past" style="display: block;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background present" style="display: block;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: block;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: block;" data-loaded="true"><div class="slide-background-content"></div><div class="slide-background present" style="display: block;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div><div class="slide-background columns is-vcentered present" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div><div class="slide-background past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background past" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background present" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div><div class="slide-background present" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;" data-loaded="true"><div class="slide-background-content"></div><div class="slide-background columns is-vcentered present" style="display: none;" data-loaded="true"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;"><div class="slide-background-content"></div><div class="slide-background present" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;"><div class="slide-background-content"></div><div class="slide-background present" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;"><div class="slide-background-content"></div><div class="slide-background present" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;"><div class="slide-background-content"></div><div class="slide-background present" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;"><div class="slide-background-content"></div><div class="slide-background present" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns is-vcentered future" style="display: none;"><div class="slide-background-content"></div></div></div><div class="slide-background stack future" style="display: none;"><div class="slide-background-content"></div><div class="slide-background present" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div><div class="slide-background columns future" style="display: none;"><div class="slide-background-content"></div></div></div></div><div class="progress" style="display: block;"><span style="width: 0px;"></span></div><aside class="controls" style="display: block;" data-controls-layout="bottom-right" data-controls-back-arrows="faded"><button class="navigate-left" aria-label="previous slide" disabled="disabled"><div class="controls-arrow"></div></button><button class="navigate-right enabled" aria-label="next slide"><div class="controls-arrow"></div></button><button class="navigate-up" aria-label="above slide" disabled="disabled"><div class="controls-arrow"></div></button><button class="navigate-down" aria-label="below slide" disabled="disabled"><div class="controls-arrow"></div></button></aside><div class="slide-number" style="display: block;"><a href="#/"><span class="slide-number-a">1</span></a></div><div class="speaker-notes" data-prevent-swipe="" tabindex="0"></div><div class="pause-overlay"><button class="resume-button">Resume presentation</button></div><div style="position: absolute; height: 1px; width: 1px; overflow: hidden; clip: rect(1px, 1px, 1px, 1px);" id="aria-status-div" aria-live="polite" aria-atomic="true">Spark Programming Training08-10 Mars 2023Amine HADJ-YOUCEF. PhD</div></div><script src="Spark%20Programming%20Training_files/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
});

// More info about config & dependencies:
// - https://github.com/hakimel/reveal.js#configuration
// - https://github.com/hakimel/reveal.js#dependencies
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Add the current slide number to the URL hash so that reloading the
  // page/copying the URL will return you to the same slide
  hash: true,
  // Push each slide change to the browser history. Implies `hash: true`
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Disables the default reveal.js slide layout so that you can use custom CSS layout
  disableLayout: false,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // See https://github.com/hakimel/reveal.js/#navigation-mode
  navigationMode: 'default',
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Global override for preloading lazy-loaded iframes
  // - null: Iframes with data-src AND data-preload will be loaded when within
  //   the viewDistance, iframes with only data-src will be loaded when visible
  // - true: All iframes with data-src will be loaded when within the viewDistance
  // - false: All iframes with data-src will be loaded only when visible
  preloadIframes: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Specify the total time in seconds that is available to
  // present.  If this is set to a nonzero value, the pacing
  // timer will work out the time available for each slide,
  // instead of using the defaultTiming value
  totalTime: 0,
  // Specify the minimum amount of time you want to allot to
  // each slide, if using the totalTime calculation method.  If
  // the automated time allocation causes slide pacing to fall
  // below this threshold, then you will see an alert in the
  // speaker notes window
  minimumTimePerSlide: 0,
  // Enable slide navigation via mouse wheel
  mouseWheel: true,
  // Hide cursor if inactive
  hideInactiveCursor: true,
  // Time before the cursor is hidden (in ms)
  hideCursorTime: 5000,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'slide',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Number of slides away from the current that are visible on mobile
  // devices. It is advisable to set this to a lower number than
  // viewDistance in order to save resources.
  mobileViewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1920,
  height: 1080,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 2.0,

  // PDF Export Options
  // Put each fragment on a separate page
  pdfSeparateFragments: true,
  // For slides that do not fit on a page, max number of pages
  pdfMaxPagesPerSlide: 1,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.9.2/plugin/zoom-js/zoom.js', async: true },
      { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.9.2/plugin/notes/notes.js', async: true }
  ],

  

});</script><script>var dom = {};
dom.slides = document.querySelector('.reveal .slides');

function getRemainingHeight(element, slideElement, height) {
  height = height || 0;
  if (element) {
    var newHeight, oldHeight = element.style.height;
    // Change the .stretch element height to 0 in order find the height of all
    // the other elements
    element.style.height = '0px';
    // In Overview mode, the parent (.slide) height is set of 700px.
    // Restore it temporarily to its natural height.
    slideElement.style.height = 'auto';
    newHeight = height - slideElement.offsetHeight;
    // Restore the old height, just in case
    element.style.height = oldHeight + 'px';
    // Clear the parent (.slide) height. .removeProperty works in IE9+
    slideElement.style.removeProperty('height');
    return newHeight;
  }
  return height;
}

function layoutSlideContents(width, height) {
  // Handle sizing of elements with the 'stretch' class
  toArray(dom.slides.querySelectorAll('section .stretch')).forEach(function (element) {
    // Determine how much vertical space we can use
    var limit = 5; // hard limit
    var parent = element.parentNode;
    while (parent.nodeName !== 'SECTION' && limit > 0) {
      parent = parent.parentNode;
      limit--;
    }
    if (limit === 0) {
      // unable to find parent, aborting!
      return;
    }
    var remainingHeight = getRemainingHeight(element, parent, height);
    // Consider the aspect ratio of media elements
    if (/(img|video)/gi.test(element.nodeName)) {
      var nw = element.naturalWidth || element.videoWidth, nh = element.naturalHeight || element.videoHeight;
      var es = Math.min(width / nw, remainingHeight / nh);
      element.style.width = (nw * es) + 'px';
      element.style.height = (nh * es) + 'px';
    } else {
      element.style.width = width + 'px';
      element.style.height = remainingHeight + 'px';
    }
  });
}

function toArray(o) {
  return Array.prototype.slice.call(o);
}

Reveal.addEventListener('slidechanged', function () {
  layoutSlideContents(1920, 1080)
});
Reveal.addEventListener('ready', function () {
  layoutSlideContents(1920, 1080)
});
Reveal.addEventListener('resize', function () {
  layoutSlideContents(1920, 1080)
});</script><link rel="stylesheet" href="Spark%20Programming%20Training_files/monokai.css">
<script src="Spark%20Programming%20Training_files/highlight.min.js"></script>

<script>

/* highlightjs-line-numbers.js 2.6.0 | (C) 2018 Yauheni Pakala | MIT License | github.com/wcoder/highlightjs-line-numbers.js */
/* Edited by Hakim for reveal.js; removed async timeout */
!function(n,e){"use strict";function t(){var n=e.createElement("style");n.type="text/css",n.innerHTML=g(".{0}{border-collapse:collapse}.{0} td{padding:0}.{1}:before{content:attr({2})}",[v,L,b]),e.getElementsByTagName("head")[0].appendChild(n)}function r(t){"interactive"===e.readyState||"complete"===e.readyState?i(t):n.addEventListener("DOMContentLoaded",function(){i(t)})}function i(t){try{var r=e.querySelectorAll("code.hljs,code.nohighlight");for(var i in r)r.hasOwnProperty(i)&&l(r[i],t)}catch(o){n.console.error("LineNumbers error: ",o)}}function l(n,e){"object"==typeof n&&f(function(){n.innerHTML=s(n,e)})}function o(n,e){if("string"==typeof n){var t=document.createElement("code");return t.innerHTML=n,s(t,e)}}function s(n,e){e=e||{singleLine:!1};var t=e.singleLine?0:1;return c(n),a(n.innerHTML,t)}function a(n,e){var t=u(n);if(""===t[t.length-1].trim()&&t.pop(),t.length>e){for(var r="",i=0,l=t.length;i<l;i++)r+=g('<tr><td class="{0}"><div class="{1} {2}" {3}="{5}"></div></td><td class="{4}"><div class="{1}">{6}</div></td></tr>',[j,m,L,b,p,i+1,t[i].length>0?t[i]:" "]);return g('<table class="{0}">{1}</table>',[v,r])}return n}function c(n){var e=n.childNodes;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];h(r.textContent)>0&&(r.childNodes.length>0?c(r):d(r.parentNode))}}function d(n){var e=n.className;if(/hljs-/.test(e)){for(var t=u(n.innerHTML),r=0,i="";r<t.length;r++){var l=t[r].length>0?t[r]:" ";i+=g('<span class="{0}">{1}</span>\n',[e,l])}n.innerHTML=i.trim()}}function u(n){return 0===n.length?[]:n.split(y)}function h(n){return(n.trim().match(y)||[]).length}function f(e){e()}function g(n,e){return n.replace(/{(\d+)}/g,function(n,t){return e[t]?e[t]:n})}var v="hljs-ln",m="hljs-ln-line",p="hljs-ln-code",j="hljs-ln-numbers",L="hljs-ln-n",b="data-line-number",y=/\r\n|\r|\n/g;n.hljs?(n.hljs.initLineNumbersOnLoad=r,n.hljs.lineNumbersBlock=l,n.hljs.lineNumbersValue=o,t()):n.console.error("highlight.js not detected!")}(window,document);

/**
 * This reveal.js plugin is wrapper around the highlight.js
 * syntax highlighting library.
 */
(function( root, factory ) {
  if (typeof define === 'function' && define.amd) {
    root.RevealHighlight = factory();
  } else if( typeof exports === 'object' ) {
    module.exports = factory();
  } else {
    // Browser globals (root is window)
    root.RevealHighlight = factory();
  }
}( this, function() {

  // Function to perform a better "data-trim" on code snippets
  // Will slice an indentation amount on each line of the snippet (amount based on the line having the lowest indentation length)
  function betterTrim(snippetEl) {
    // Helper functions
    function trimLeft(val) {
      // Adapted from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill
      return val.replace(/^[\s\uFEFF\xA0]+/g, '');
    }
    function trimLineBreaks(input) {
      var lines = input.split('\n');

      // Trim line-breaks from the beginning
      for (var i = 0; i < lines.length; i++) {
        if (lines[i].trim() === '') {
          lines.splice(i--, 1);
        } else break;
      }

      // Trim line-breaks from the end
      for (var i = lines.length-1; i >= 0; i--) {
        if (lines[i].trim() === '') {
          lines.splice(i, 1);
        } else break;
      }

      return lines.join('\n');
    }

    // Main function for betterTrim()
    return (function(snippetEl) {
      var content = trimLineBreaks(snippetEl.innerHTML);
      var lines = content.split('\n');
      // Calculate the minimum amount to remove on each line start of the snippet (can be 0)
      var pad = lines.reduce(function(acc, line) {
        if (line.length > 0 && trimLeft(line).length > 0 && acc > line.length - trimLeft(line).length) {
          return line.length - trimLeft(line).length;
        }
        return acc;
      }, Number.POSITIVE_INFINITY);
      // Slice each line with this amount
      return lines.map(function(line, index) {
        return line.slice(pad);
      })
        .join('\n');
    })(snippetEl);
  }

  var RevealHighlight = {

    HIGHLIGHT_STEP_DELIMITER: '|',
    HIGHLIGHT_LINE_DELIMITER: ',',
    HIGHLIGHT_LINE_RANGE_DELIMITER: '-',

    init: function() {

      // Read the plugin config options and provide fallbacks
      var config = Reveal.getConfig().highlight || {};
      config.highlightOnLoad = typeof config.highlightOnLoad === 'boolean' ? config.highlightOnLoad : true;
      config.escapeHTML = typeof config.escapeHTML === 'boolean' ? config.escapeHTML : true;

      [].slice.call( document.querySelectorAll( '.reveal pre code' ) ).forEach( function( block ) {

        // Trim whitespace if the "data-trim" attribute is present
        if( block.hasAttribute( 'data-trim' ) && typeof block.innerHTML.trim === 'function' ) {
          block.innerHTML = betterTrim( block );
        }

        // Escape HTML tags unless the "data-noescape" attrbute is present
        if( config.escapeHTML && !block.hasAttribute( 'data-noescape' )) {
          block.innerHTML = block.innerHTML.replace( /</g,"&lt;").replace(/>/g, '&gt;' );
        }

        // Re-highlight when focus is lost (for contenteditable code)
        block.addEventListener( 'focusout', function( event ) {
          hljs.highlightBlock( event.currentTarget );
        }, false );

        if( config.highlightOnLoad ) {
          RevealHighlight.highlightBlock( block );
        }
      } );

    },

    /**
     * Highlights a code block. If the <code> node has the
     * 'data-line-numbers' attribute we also generate slide
     * numbers.
     *
     * If the block contains multiple line highlight steps,
     * we clone the block and create a fragment for each step.
     */
    highlightBlock: function( block ) {

      hljs.highlightBlock( block );

      // Don't generate line numbers for empty code blocks
      if( block.innerHTML.trim().length === 0 ) return;

      if( block.hasAttribute( 'data-line-numbers' ) ) {
        hljs.lineNumbersBlock( block, { singleLine: true } );

        // If there is at least one highlight step, generate
        // fragments
        var highlightSteps = RevealHighlight.deserializeHighlightSteps( block.getAttribute( 'data-line-numbers' ) );
        if( highlightSteps.length > 1 ) {

          // If the original code block has a fragment-index,
          // each clone should follow in an incremental sequence
          var fragmentIndex = parseInt( block.getAttribute( 'data-fragment-index' ), 10 );
          if( typeof fragmentIndex !== 'number' || isNaN( fragmentIndex ) ) {
            fragmentIndex = null;
          }

          // Generate fragments for all steps except the original block
          highlightSteps.slice(1).forEach( function( highlight ) {

            var fragmentBlock = block.cloneNode( true );
            fragmentBlock.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlight ] ) );
            fragmentBlock.classList.add( 'fragment' );
            block.parentNode.appendChild( fragmentBlock );
            RevealHighlight.highlightLines( fragmentBlock );

            if( typeof fragmentIndex === 'number' ) {
              fragmentBlock.setAttribute( 'data-fragment-index', fragmentIndex );
              fragmentIndex += 1;
            }
            else {
              fragmentBlock.removeAttribute( 'data-fragment-index' );
            }

          } );

          block.removeAttribute( 'data-fragment-index' )
          block.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlightSteps[0] ] ) );

        }

        RevealHighlight.highlightLines( block );

      }

    },

    /**
     * Visually emphasize specific lines within a code block.
     * This only works on blocks with line numbering turned on.
     *
     * @param {HTMLElement} block a <code> block
     * @param {String} [linesToHighlight] The lines that should be
     * highlighted in this format:
     * "1" 		= highlights line 1
     * "2,5"	= highlights lines 2 & 5
     * "2,5-7"	= highlights lines 2, 5, 6 & 7
     */
    highlightLines: function( block, linesToHighlight ) {

      var highlightSteps = RevealHighlight.deserializeHighlightSteps( linesToHighlight || block.getAttribute( 'data-line-numbers' ) );

      if( highlightSteps.length ) {

        highlightSteps[0].forEach( function( highlight ) {

          var elementsToHighlight = [];

          // Highlight a range
          if( typeof highlight.end === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child(n+'+highlight.start+'):nth-child(-n+'+highlight.end+')' ) );
          }
          // Highlight a single line
          else if( typeof highlight.start === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child('+highlight.start+')' ) );
          }

          if( elementsToHighlight.length ) {
            elementsToHighlight.forEach( function( lineElement ) {
              lineElement.classList.add( 'highlight-line' );
            } );

            block.classList.add( 'has-highlights' );
          }

        } );

      }

    },

    /**
     * Parses and formats a user-defined string of line
     * numbers to highlight.
     *
     * @example
     * RevealHighlight.deserializeHighlightSteps( '1,2|3,5-10' )
     * // [
     * //   [ { start: 1 }, { start: 2 } ],
     * //   [ { start: 3 }, { start: 5, end: 10 } ]
     * // ]
     */
    deserializeHighlightSteps: function( highlightSteps ) {

      // Remove whitespace
      highlightSteps = highlightSteps.replace( /\s/g, '' );

      // Divide up our line number groups
      highlightSteps = highlightSteps.split( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

      return highlightSteps.map( function( highlights ) {

        return highlights.split( RevealHighlight.HIGHLIGHT_LINE_DELIMITER ).map( function( highlight ) {

          // Parse valid line numbers
          if( /^[\d-]+$/.test( highlight ) ) {

            highlight = highlight.split( RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER );

            var lineStart = parseInt( highlight[0], 10 ),
              lineEnd = parseInt( highlight[1], 10 );

            if( isNaN( lineEnd ) ) {
              return {
                start: lineStart
              };
            }
            else {
              return {
                start: lineStart,
                end: lineEnd
              };
            }

          }
          // If no line numbers are provided, no code will be highlighted
          else {

            return {};

          }

        } );

      } );

    },

    /**
     * Serializes parsed line number data into a string so
     * that we can store it in the DOM.
     */
    serializeHighlightSteps: function( highlightSteps ) {

      return highlightSteps.map( function( highlights ) {

        return highlights.map( function( highlight ) {

          // Line range
          if( typeof highlight.end === 'number' ) {
            return highlight.start + RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER + highlight.end;
          }
          // Single line
          else if( typeof highlight.start === 'number' ) {
            return highlight.start;
          }
          // All lines
          else {
            return '';
          }

        } ).join( RevealHighlight.HIGHLIGHT_LINE_DELIMITER );

      } ).join( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

    }

  }

  Reveal.registerPlugin( 'highlight', RevealHighlight );

  return RevealHighlight;

}));
        
hljs.initHighlightingOnLoad();
</script><!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body></html>